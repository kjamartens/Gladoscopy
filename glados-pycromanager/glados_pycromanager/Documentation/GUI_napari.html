<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>GUI_napari API documentation</title>
<meta name="description" content="The main function to call if running glados-napari from the python interface." />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>GUI_napari</code></h1>
</header>
<section id="section-intro">
<p>The main function to call if running glados-napari from the python interface.</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#34;&#34;&#34;
The main function to call if running glados-napari from the python interface.
&#34;&#34;&#34;

#region imports
from pycromanager import Core
from pycromanager import start_headless
import os
os.environ[&#39;NAPARI_ASYNC&#39;] = &#39;1&#39;
os.environ[&#39;NAPARI_OCTREE&#39;] = &#39;1&#39; #this is rather smoother than async
import json
import sys
from PyQt5.QtWidgets import QApplication
import shutil
import logging
import argparse
from PyQt5.QtCore import QThread, QObject, pyqtSignal
from PyQt5.QtWidgets import QApplication, QMainWindow
import sys


def is_pip_installed():
    return &#39;site-packages&#39; in __file__ or &#39;dist-packages&#39; in __file__

if is_pip_installed():
    from glados_pycromanager.GUI.napariGlados import runNapariPycroManager
    from glados_pycromanager.GUI.sharedFunctions import Shared_data, periodicallyUpdate
    from glados_pycromanager.GUI.utils import *

    from glados_pycromanager.AutonomousMicroscopy.Analysis_Images import * #type: ignore
    from glados_pycromanager.AutonomousMicroscopy.Analysis_Measurements import * #type: ignore
    from glados_pycromanager.AutonomousMicroscopy.Analysis_Shapes import * #type: ignore
    from glados_pycromanager.AutonomousMicroscopy.Real_Time_Analysis import * #type: ignore
    #Obtain the helperfunctions
    import glados_pycromanager.GUI.utils as utils
else:
    from napariGlados import runNapariPycroManager
    from sharedFunctions import Shared_data, periodicallyUpdate
    from utils import *

    # Add the folder 2 folders up to the system path
    sys.path.append(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))
    #Import all scripts in the custom script folders
    from Analysis_Images import * #type: ignore
    from Analysis_Measurements import * #type: ignore
    from Analysis_Shapes import * #type: ignore
    from Real_Time_Analysis import * #type: ignore
    #Obtain the helperfunctions
    import utils
#endregion

def perform_post_closing_actions(shared_data):
    &#34;&#34;&#34;Performing closing actions

    Args:
        shared_data: shared_data class (Shared_data())
    &#34;&#34;&#34;
    #Clean up temporary files
    utils.cleanUpTemporaryFiles(shared_data=shared_data)
    
    # if shared_data._headless:
    #     stop_headless()

class Worker(QObject):
    &#34;&#34;&#34;
    Worker wrapper for the runNapariPycroManager function
    &#34;&#34;&#34;
    finished = pyqtSignal()

    def runNapariPycroManagerWrap(self, core, MM_JSON, shared_data,includeCustomUI=True):
        &#34;&#34;&#34;
        Runs the NapariPycroManagerWrap function.
        
        Args:
            core: The core object.
            MM_JSON: The MM_JSON object.
            shared_data: The shared data object.
            includeCustomUI (bool, optional): Flag to include custom UI. Defaults to False.
        
        Returns:
            None
        &#34;&#34;&#34;
        
        # Your code for running the NapariPycroManager function goes here
        runNapariPycroManager(core, MM_JSON, shared_data,includecustomUI=includeCustomUI)
        self.finished.emit()

def main():
    &#34;&#34;&#34;
    Run the main function to start Glados-PycroManager-Napari interface for autonomous microscopy.
    
    Args:
        None
    
    Returns:
        None
    &#34;&#34;&#34;
    
    #Create parser
    parser = argparse.ArgumentParser(description=&#39;Glados-PycroManager-Napari: an interface for autonomous microscopy via PycroManager&#39;)
    parser.add_argument(&#39;--debug&#39;, &#39;-d&#39;, action=&#39;store_true&#39;, help=&#39;Enable debug&#39;)
    args=parser.parse_args()
    
    
    # Create an instance of the shared_data class
    shared_data = Shared_data()
    utils.cleanUpTemporaryFiles(shared_data=shared_data)
        
    # get object representing MMCore, used throughout
    #try to open a running instance:
    try:
        core = Core()
        shared_data.core = core
        shared_data._headless = False
    except:
        #else, create a new headless instance:
        print(&#39;Starting headless MM&#39;)
        start_headless(mm_app_path= &#34;C:\\Program Files\\Micro-Manager-2.0gamma\\&#34;, config_file=&#34;C:\\Users\\SMIPC2\\Desktop\\MM-config\\MMconfig_20240103c.cfg&#34;, python_backend=False, buffer_size_mb=2048, max_memory_mb=10000)
        shared_data._headless = True
        print(&#39;headless MM started&#39;)
        core = Core()
        shared_data.core = core

    #Open JSON file with MM settings
    try:
        with open(os.path.join(sys.path[0], &#39;MM_PycroManager_JSON.json&#39;), &#39;r&#39;) as f:
            MM_JSON = json.load(f)
    except:
        MM_JSON = None
        
        
    from PyQt5.QtWidgets import QApplication
    from PyQt5.QtCore import Qt
    QApplication.setAttribute(Qt.AA_ShareOpenGLContexts) #type:ignore

    #Run the UI on a second thread (hopefully robustly)
    app = QApplication(sys.argv)

    worker = Worker()
    thread = QThread()
    worker.moveToThread(thread)
    thread.started.connect(lambda: worker.runNapariPycroManagerWrap(core, MM_JSON, shared_data))
    thread.start()
    
    worker.finished.connect(thread.quit)
    worker.finished.connect(worker.deleteLater)
    thread.finished.connect(thread.deleteLater)

    #Set up logging to files in appData folder - INFO and DEBUG
    utils.set_up_logger()
    
    #Run the app until closed
    sys.exit(app.exec_())

    #Run the UI
    # import threading
    # thread = threading.Thread(target=runNapariPycroManager, args=(core, MM_JSON, shared_data))
    # thread.start()
    # # nPM = runNapariPycroManager(core,MM_JSON,shared_data)

    # #Periodically update the MM info of the MMcontrolsWidget
    # global MM_update_instance
    # # MM_update_instance = periodicallyUpdate(updateFunction=nPM[&#39;MMcontrolWidget&#39;].updateAllMMinfo)

    # #Ensure it stays open
    # app = QApplication([])
    # app.aboutToQuit.connect(lambda: perform_post_closing_actions(shared_data))
    # sys.exit(app.exec_())

if __name__ == &#34;__main__&#34;:
    # try:
    main()
    # except:
        # print(&#39;Error!&#39;)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="GUI_napari.main"><code class="name flex">
<span>def <span class="ident">main</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Run the main function to start Glados-PycroManager-Napari interface for autonomous microscopy.</p>
<h2 id="args">Args</h2>
<p>None</p>
<h2 id="returns">Returns</h2>
<p>None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def main():
    &#34;&#34;&#34;
    Run the main function to start Glados-PycroManager-Napari interface for autonomous microscopy.
    
    Args:
        None
    
    Returns:
        None
    &#34;&#34;&#34;
    
    #Create parser
    parser = argparse.ArgumentParser(description=&#39;Glados-PycroManager-Napari: an interface for autonomous microscopy via PycroManager&#39;)
    parser.add_argument(&#39;--debug&#39;, &#39;-d&#39;, action=&#39;store_true&#39;, help=&#39;Enable debug&#39;)
    args=parser.parse_args()
    
    
    # Create an instance of the shared_data class
    shared_data = Shared_data()
    utils.cleanUpTemporaryFiles(shared_data=shared_data)
        
    # get object representing MMCore, used throughout
    #try to open a running instance:
    try:
        core = Core()
        shared_data.core = core
        shared_data._headless = False
    except:
        #else, create a new headless instance:
        print(&#39;Starting headless MM&#39;)
        start_headless(mm_app_path= &#34;C:\\Program Files\\Micro-Manager-2.0gamma\\&#34;, config_file=&#34;C:\\Users\\SMIPC2\\Desktop\\MM-config\\MMconfig_20240103c.cfg&#34;, python_backend=False, buffer_size_mb=2048, max_memory_mb=10000)
        shared_data._headless = True
        print(&#39;headless MM started&#39;)
        core = Core()
        shared_data.core = core

    #Open JSON file with MM settings
    try:
        with open(os.path.join(sys.path[0], &#39;MM_PycroManager_JSON.json&#39;), &#39;r&#39;) as f:
            MM_JSON = json.load(f)
    except:
        MM_JSON = None
        
        
    from PyQt5.QtWidgets import QApplication
    from PyQt5.QtCore import Qt
    QApplication.setAttribute(Qt.AA_ShareOpenGLContexts) #type:ignore

    #Run the UI on a second thread (hopefully robustly)
    app = QApplication(sys.argv)

    worker = Worker()
    thread = QThread()
    worker.moveToThread(thread)
    thread.started.connect(lambda: worker.runNapariPycroManagerWrap(core, MM_JSON, shared_data))
    thread.start()
    
    worker.finished.connect(thread.quit)
    worker.finished.connect(worker.deleteLater)
    thread.finished.connect(thread.deleteLater)

    #Set up logging to files in appData folder - INFO and DEBUG
    utils.set_up_logger()
    
    #Run the app until closed
    sys.exit(app.exec_())

    #Run the UI
    # import threading
    # thread = threading.Thread(target=runNapariPycroManager, args=(core, MM_JSON, shared_data))
    # thread.start()
    # # nPM = runNapariPycroManager(core,MM_JSON,shared_data)

    # #Periodically update the MM info of the MMcontrolsWidget
    # global MM_update_instance
    # # MM_update_instance = periodicallyUpdate(updateFunction=nPM[&#39;MMcontrolWidget&#39;].updateAllMMinfo)

    # #Ensure it stays open
    # app = QApplication([])
    # app.aboutToQuit.connect(lambda: perform_post_closing_actions(shared_data))
    # sys.exit(app.exec_())</code></pre>
</details>
</dd>
<dt id="GUI_napari.perform_post_closing_actions"><code class="name flex">
<span>def <span class="ident">perform_post_closing_actions</span></span>(<span>shared_data)</span>
</code></dt>
<dd>
<div class="desc"><p>Performing closing actions</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>shared_data</code></strong></dt>
<dd>shared_data class (Shared_data())</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def perform_post_closing_actions(shared_data):
    &#34;&#34;&#34;Performing closing actions

    Args:
        shared_data: shared_data class (Shared_data())
    &#34;&#34;&#34;
    #Clean up temporary files
    utils.cleanUpTemporaryFiles(shared_data=shared_data)
    
    # if shared_data._headless:
    #     stop_headless()</code></pre>
</details>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="GUI_napari.Worker"><code class="flex name class">
<span>class <span class="ident">Worker</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Worker wrapper for the runNapariPycroManager function</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Worker(QObject):
    &#34;&#34;&#34;
    Worker wrapper for the runNapariPycroManager function
    &#34;&#34;&#34;
    finished = pyqtSignal()

    def runNapariPycroManagerWrap(self, core, MM_JSON, shared_data,includeCustomUI=True):
        &#34;&#34;&#34;
        Runs the NapariPycroManagerWrap function.
        
        Args:
            core: The core object.
            MM_JSON: The MM_JSON object.
            shared_data: The shared data object.
            includeCustomUI (bool, optional): Flag to include custom UI. Defaults to False.
        
        Returns:
            None
        &#34;&#34;&#34;
        
        # Your code for running the NapariPycroManager function goes here
        runNapariPycroManager(core, MM_JSON, shared_data,includecustomUI=includeCustomUI)
        self.finished.emit()</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt5.QtCore.QObject</li>
<li>sip.wrapper</li>
<li>sip.simplewrapper</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="GUI_napari.Worker.finished"><code class="name flex">
<span>def <span class="ident">finished</span></span>(<span>...)</span>
</code></dt>
<dd>
<div class="desc"><p>pyqtSignal(*types, name: str = &hellip;, revision: int = &hellip;, arguments: Sequence = &hellip;) -&gt; PYQT_SIGNAL</p>
<p>types is normally a sequence of individual types.
Each type is either a
type object or a string that is the name of a C++ type.
Alternatively
each type could itself be a sequence of types each describing a different
overloaded signal.
name is the optional C++ name of the signal.
If it is not specified then
the name of the class attribute that is bound to the signal is used.
revision is the optional revision of the signal that is exported to QML.
If it is not specified then 0 is used.
arguments is the optional sequence of the names of the signal's arguments.</p></div>
</dd>
<dt id="GUI_napari.Worker.runNapariPycroManagerWrap"><code class="name flex">
<span>def <span class="ident">runNapariPycroManagerWrap</span></span>(<span>self, core, MM_JSON, shared_data, includeCustomUI=True)</span>
</code></dt>
<dd>
<div class="desc"><p>Runs the NapariPycroManagerWrap function.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>core</code></strong></dt>
<dd>The core object.</dd>
<dt><strong><code>MM_JSON</code></strong></dt>
<dd>The MM_JSON object.</dd>
<dt><strong><code>shared_data</code></strong></dt>
<dd>The shared data object.</dd>
<dt><strong><code>includeCustomUI</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Flag to include custom UI. Defaults to False.</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def runNapariPycroManagerWrap(self, core, MM_JSON, shared_data,includeCustomUI=True):
    &#34;&#34;&#34;
    Runs the NapariPycroManagerWrap function.
    
    Args:
        core: The core object.
        MM_JSON: The MM_JSON object.
        shared_data: The shared data object.
        includeCustomUI (bool, optional): Flag to include custom UI. Defaults to False.
    
    Returns:
        None
    &#34;&#34;&#34;
    
    # Your code for running the NapariPycroManager function goes here
    runNapariPycroManager(core, MM_JSON, shared_data,includecustomUI=includeCustomUI)
    self.finished.emit()</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="GUI_napari.main" href="#GUI_napari.main">main</a></code></li>
<li><code><a title="GUI_napari.perform_post_closing_actions" href="#GUI_napari.perform_post_closing_actions">perform_post_closing_actions</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="GUI_napari.Worker" href="#GUI_napari.Worker">Worker</a></code></h4>
<ul class="">
<li><code><a title="GUI_napari.Worker.finished" href="#GUI_napari.Worker.finished">finished</a></code></li>
<li><code><a title="GUI_napari.Worker.runNapariPycroManagerWrap" href="#GUI_napari.Worker.runNapariPycroManagerWrap">runNapariPycroManagerWrap</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>